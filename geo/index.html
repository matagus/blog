

<!DOCTYPE html>
<html>
<head>
  <meta charset=utf-8 />
  <title>Markercluster with Mapbox marker data</title>
  <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src='https://api.tiles.mapbox.com/mapbox.js/v2.1.2/mapbox.js'></script>
  <link href='https://api.tiles.mapbox.com/mapbox.js/v2.1.2/mapbox.css' rel='stylesheet' />
  <style>
    body { margin:0; padding:0; }
    #map { position:absolute; top:0; bottom:0; width:100%; }
  </style>
  <script src='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/leaflet.markercluster.js'></script>
  <link href='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/MarkerCluster.css' rel='stylesheet' />
  <link href='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/MarkerCluster.Default.css' rel='stylesheet' />
</head>
<body>
  <div id='map'></div>
</body>
<script>
  L.mapbox.accessToken = 'pk.eyJ1IjoibWF0YWd1cyIsImEiOiJHaEdPVEQwIn0.-Ozf1tLmk77e8WsCXkxw1A';
  // Here we don't use the second argument to map, since that would automatically
  // load in non-clustered markers from the layer. Instead we add just the
  // backing tileLayer, and then use the featureLayer only for its data.
  var map = L.mapbox.map('map', 'matagus.jni44nnb');
  var geojsonUrl = "https://raw.githubusercontent.com/matagus/matagus.github.com/a4f0c4bc3d5e96ccf995d544e122bf4691830acb/geo/tuneins.geojson";

  $.getJSON(geojsonUrl, function(data) {
    // Since featureLayer is an asynchronous method, we use the `.on('ready'`
    // call to only use its marker data once we know it is actually loaded.
    L.mapbox.featureLayer(data).on('ready', function(e) {
      // The clusterGroup gets each marker in the group added to it
      // once loaded, and then is added to the map
      var clusterGroup = new L.MarkerClusterGroup();
      e.target.eachLayer(function(layer) {
          clusterGroup.addLayer(layer);
      });
      map.addLayer(clusterGroup);
    });
  });
</script>
</html>
